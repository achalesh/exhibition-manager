<%- include('partials/header') %>

<div class="container-fluid">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0"><%= title %></h2>
    <a href="/booking/add" class="btn btn-primary"><i class="bi bi-plus-circle me-1"></i> New Booking</a>
  </div>

  <!-- Filters and Search -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <div class="row align-items-center">
        <div class="col-md-5">
          <form action="/booking/list" method="GET" class="d-flex">
            <input type="text" name="q" class="form-control me-2" placeholder="Search by Exhibitor, Facia, Space..." value="<%= filters.q || '' %>">
            <input type="hidden" name="form_status" value="<%= currentFilter %>">
            <button type="submit" class="btn btn-primary"><i class="bi bi-search"></i></button>
            <% if (filters.q) { %>
              <a href="/booking/list?form_status=<%= currentFilter %>" class="btn btn-outline-secondary ms-2">Clear</a>
            <% } %>
          </form>
        </div>
        <div class="col-md-7 text-md-end mt-3 mt-md-0">
          <strong>Filter by Form Status:</strong>
          <a href="/booking/list?q=<%= filters.q || '' %>&form_status=all" class="btn btn-sm <%= currentFilter === 'all' ? 'btn-primary' : 'btn-outline-secondary' %>">All</a>
          <a href="/booking/list?q=<%= filters.q || '' %>&form_status=submitted" class="btn btn-sm <%= currentFilter === 'submitted' ? 'btn-primary' : 'btn-outline-secondary' %>">Submitted</a>
          <a href="/booking/list?q=<%= filters.q || '' %>&form_status=not_submitted" class="btn btn-sm <%= currentFilter === 'not_submitted' ? 'btn-primary' : 'btn-outline-secondary' %>">Not Submitted</a>
        </div>
      </div><div class="mt-3 text-end">
        <a href="/report/booking-summary" class="btn btn-info btn-sm"><i class="bi bi-file-earmark-text me-1"></i> View Summary Report</a>
      </div>
    </div>
  </div>

  <% if (message) { %>
    <div class="alert alert-info"><%= message %></div>
  <% } %>

  <div class="card shadow-sm">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead class="table-light">
            <tr>
              <th>#</th>
              <th>Exhibitor Name</th>
              <th>Facia Name</th>
              <th>Space</th>
              <th>Contact Number</th>
              <th>Secondary Number</th>
              <th>Form Submitted</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% if (bookings && bookings.length > 0) { %>
              <% bookings.forEach((booking, index) => { %>
                <tr>
                  <td><%= index + 1 %></td>
                  <td><%= booking.client_name %></td>
                  <td><%= booking.facia_name || 'N/A' %></td>
                  <td><%= booking.space_name %> (<%= booking.space_type %>)</td>
                  <td><%= booking.contact_number || 'N/A' %></td>
                  <td><%= booking.secondary_number || 'N/A' %></td>
                  <td>
                    <span class="badge bg-<%= booking.form_submitted ? 'success' : 'warning' %>">
                      <%= booking.form_submitted ? 'Yes' : 'No' %>
                    </span>
                  </td>
                  <td>
                    <a href="/booking/details-full/<%= booking.id %>" class="btn btn-sm btn-primary">Details</a>
                  </td>
                </tr>
              <% }) %>
            <% } else { %>
              <tr>
                <td colspan="8" class="text-center text-muted">No bookings found for the current filter.</td>
              </tr>
            <% } %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<%- include('partials/footer') %>