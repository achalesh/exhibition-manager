<%- include('partials/header') %>

<div class="container mt-3">
    <div class="d-flex justify-content-between align-items-center mb-2">
        <div>
            <h4><%= title %></h4>
        </div>
        <div>
            <button onclick="window.print()" class="btn btn-primary d-print-none me-2">Print Report</button>
            <button id="download-excel" class="btn btn-success d-print-none">Download Excel</button>
        </div>
    </div>
    <div class="table-responsive">
        <table class="table table-bordered table-striped">
            <thead class="thead-dark">
                <tr>
                    <th>#</th>
                    <th>Shed Name</th>
                    <th>Allocated To / Facia Name [Main Space]</th>
                    <th class="text-right">Shed Rent</th>
                </tr>
            </thead>
            <tbody>
                <% if (allocations && allocations.length > 0) { %>
                    <% allocations.forEach((item, index) => { %>
                        <tr>
                            <td><%= index + 1 %></td>
                            <td><%= item.shed_name %></td>
                            <td>
                                <%= item.exhibitor_name %>
                                <% if (item.facia_name) { %><br><small class="text-muted">(<%= item.facia_name %>)</small><% } %>
                                <br><small class="text-info">[<%= item.space_name %>]</small>
                            </td>
                            <td class="text-right"><%= (item.rent || 0).toFixed(2) %></td>
                        </tr>
                    <% }); %>
                <% } else { %>
                    <tr>
                        <td colspan="4" class="text-center">No sheds have been allocated.</td>
                    </tr>
                <% } %>
            </tbody>
        </table>
    </div>
</div>

<script>
    document.getElementById('download-excel').addEventListener('click', function() {
        // Trigger Excel download
        window.location.href = '/report/downloadExcelSheds';
    });
</script>

<%- include('partials/footer') %>